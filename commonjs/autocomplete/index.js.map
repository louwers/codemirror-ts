{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../src/autocomplete/index.ts"],"names":[],"mappings":";;;AAKA,iEAA2D;AAG3D,SAAgB,cAAc,CAAC,EAC7B,IAAI,EACJ,GAAG,GAIJ;IACC,OAAO,KAAK,EACV,OAA0B,EACQ,EAAE;QACpC,OAAO,IAAA,wCAAiB,EAAC;YACvB,GAAG;YACH,IAAI;YACJ,OAAO;SACR,CAAC,CAAC;IACL,CAAC,CAAC;AACJ,CAAC;AAhBD,wCAgBC;AAED,SAAgB,oBAAoB,CAAC,EACnC,IAAI,EACJ,MAAM,GAYP;IACC,OAAO,KAAK,EACV,OAA0B,EACQ,EAAE;QACpC,OAAO,MAAM,CAAC,iBAAiB,CAAC;YAC9B,IAAI;YACJ,gDAAgD;YAChD,OAAO,EAAE;gBACP,GAAG,EAAE,OAAO,CAAC,GAAG;gBAChB,QAAQ,EAAE,OAAO,CAAC,QAAQ;aAC3B;SACF,CAAC,CAAC;IACL,CAAC,CAAC;AACJ,CAAC;AA3BD,oDA2BC","sourcesContent":["import type {\n  CompletionContext,\n  CompletionResult,\n} from \"@codemirror/autocomplete\";\nimport { type VirtualTypeScriptEnvironment } from \"@typescript/vfs\";\nimport { getAutocompletion } from \"./getAutocompletion.js\";\nimport * as Comlink from \"comlink\";\n\nexport function tsAutocomplete({\n  path,\n  env,\n}: {\n  path: string;\n  env: VirtualTypeScriptEnvironment;\n}) {\n  return async (\n    context: CompletionContext,\n  ): Promise<CompletionResult | null> => {\n    return getAutocompletion({\n      env,\n      path,\n      context,\n    });\n  };\n}\n\nexport function tsAutocompleteWorker({\n  path,\n  worker,\n}: {\n  path: string;\n  worker: Comlink.Remote<{\n    getAutocompletion: ({\n      path,\n      context,\n    }: {\n      path: string;\n      context: Pick<CompletionContext, \"pos\" | \"explicit\">;\n    }) => CompletionResult;\n  }>;\n}) {\n  return async (\n    context: CompletionContext,\n  ): Promise<CompletionResult | null> => {\n    return worker.getAutocompletion({\n      path,\n      // Reduce this object so that it's serializable.\n      context: {\n        pos: context.pos,\n        explicit: context.explicit,\n      },\n    });\n  };\n}\n"]}